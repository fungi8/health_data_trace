<view class="container">
  <view class="profile-header">
    <view class="avatar-container" bindtap="getUserProfile">
      <image class="avatar" src="{{userInfo.avatarUrl || '/assets/images/default-avatar.png'}}" mode="aspectFill"></image>
      <view class="avatar-edit-hint">ç‚¹å‡»æˆæƒ</view>
    </view>
    <view class="user-info">
      <view class="user-name" bindtap="editUserInfo" data-field="name">
        <text>{{userInfo.name || 'ç‚¹å‡»è®¾ç½®å§“å'}}</text>
        <text class="edit-icon">âœï¸</text>
      </view>
      <view class="user-details">
        <view class="detail-item" bindtap="editUserInfo" data-field="gender">
          <text class="label">æ€§åˆ«</text>
          <text class="value">{{userInfo.gender || 'æœªè®¾ç½®'}} <text class="edit-icon">âœï¸</text></text>
        </view>
        <view class="detail-item" bindtap="editUserInfo" data-field="age">
          <text class="label">å¹´é¾„</text>
          <text class="value">{{userInfo.age ? userInfo.age + 'å²' : 'æœªè®¾ç½®'}} <text class="edit-icon">âœï¸</text></text>
        </view>
        <view class="detail-item" bindtap="editUserInfo" data-field="height">
          <text class="label">èº«é«˜</text>
          <text class="value">{{userInfo.height ? userInfo.height + 'cm' : 'æœªè®¾ç½®'}} <text class="edit-icon">âœï¸</text></text>
        </view>
        <view class="detail-item" bindtap="editUserInfo" data-field="weight">
          <text class="label">ä½“é‡</text>
          <text class="value">{{userInfo.weight ? userInfo.weight + 'kg' : 'æœªè®¾ç½®'}} <text class="edit-icon">âœï¸</text></text>
        </view>
      </view>
    </view>
  </view>
  
  <view class="health-summary">
    <view class="summary-item">
      <text class="summary-value">{{recordCount}}</text>
      <text class="summary-label">è®°å½•æ€»æ•°</text>
    </view>
    <view class="summary-item">
      <text class="summary-value">{{recordDays}}</text>
      <text class="summary-label">è®°å½•å¤©æ•°</text>
    </view>
    <view class="summary-item">
      <text class="summary-value">{{continuousDays}}</text>
      <text class="summary-label">è¿ç»­è®°å½•</text>
    </view>
  </view>
  
  <view class="section-title">å¥åº·ç›®æ ‡</view>
  
  <view class="health-goals">
    <view class="goal-item" bindtap="editHealthGoal" data-field="targetWeight">
      <view class="goal-icon">âš–ï¸</view>
      <view class="goal-content">
        <text class="goal-label">ç›®æ ‡ä½“é‡</text>
        <text class="goal-value">{{healthGoals.targetWeight ? healthGoals.targetWeight + 'kg' : 'æœªè®¾ç½®'}}</text>
      </view>
      <text class="edit-icon">âœï¸</text>
    </view>
    <view class="goal-item" bindtap="editHealthGoal" data-field="targetBloodPressure">
      <view class="goal-icon">â¤ï¸</view>
      <view class="goal-content">
        <text class="goal-label">ç›®æ ‡è¡€å‹</text>
        <text class="goal-value">{{healthGoals.targetBloodPressure || 'æœªè®¾ç½®'}}</text>
      </view>
      <text class="edit-icon">âœï¸</text>
    </view>
    <view class="goal-item" bindtap="editHealthGoal" data-field="waterIntake">
      <view class="goal-icon">ğŸ’§</view>
      <view class="goal-content">
        <text class="goal-label">æ¯æ—¥é¥®æ°´é‡</text>
        <text class="goal-value">{{healthGoals.waterIntake ? healthGoals.waterIntake + 'ml' : 'æœªè®¾ç½®'}}</text>
      </view>
      <text class="edit-icon">âœï¸</text>
    </view>
  </view>
  
  <view class="section-title">åº”ç”¨è®¾ç½®</view>
  
  <view class="card">
    <van-cell-group>
      <van-cell title="æé†’è®¾ç½®" is-link bindtap="navigateTo" data-url="/pages/reminders/reminders" />
      <van-cell title="æ•°æ®ç®¡ç†" is-link bindtap="navigateTo" data-url="/pages/data-management/data-management" />
      <van-cell title="éšç§è®¾ç½®" is-link bindtap="navigateTo" data-url="/pages/privacy-settings/privacy-settings" />
      <van-cell title="å…³äºæˆ‘ä»¬" is-link bindtap="showAbout" />
    </van-cell-group>
  </view>
  
  <view class="action-buttons">
    <button class="btn-secondary" bindtap="exportData">å¯¼å‡ºæ•°æ®</button>
    <button class="btn-secondary" bindtap="clearData">æ¸…é™¤æ•°æ®</button>
    <button class="btn-secondary" bindtap="showAbout">å…³äºæˆ‘ä»¬</button>
  </view>
  
  <!-- ç¼–è¾‘å¼¹çª— -->
  <view class="edit-popup {{showEditPopup ? 'show' : ''}}">
    <view class="edit-popup-mask" bindtap="closeEditPopup"></view>
    <view class="edit-popup-content">
      <view class="edit-popup-header">
        <text class="edit-popup-title">ç¼–è¾‘{{editTitle}}</text>
        <text class="edit-popup-close" bindtap="closeEditPopup">Ã—</text>
      </view>
      
      <view class="edit-popup-body">
        <!-- æ€§åˆ«é€‰æ‹© -->
        <block wx:if="{{currentEditField === 'gender'}}">
          <view class="radio-group">
            <view class="radio-item {{tempEditValue === 'ç”·' ? 'active' : ''}}" bindtap="onRadioClick" data-name="ç”·">
              <text class="radio-icon">{{tempEditValue === 'ç”·' ? 'â—' : 'â—‹'}}</text>
              <text class="radio-label">ç”·</text>
            </view>
            <view class="radio-item {{tempEditValue === 'å¥³' ? 'active' : ''}}" bindtap="onRadioClick" data-name="å¥³">
              <text class="radio-icon">{{tempEditValue === 'å¥³' ? 'â—' : 'â—‹'}}</text>
              <text class="radio-label">å¥³</text>
            </view>
          </view>
        </block>
        
        <!-- å…¶ä»–å­—æ®µçš„è¾“å…¥æ¡† -->
        <block wx:else>
          <input 
            class="edit-input" 
            type="{{currentEditField === 'age' || currentEditField === 'height' || currentEditField === 'weight' || currentEditField === 'targetWeight' || currentEditField === 'waterIntake' ? 'digit' : 'text'}}" 
            value="{{tempEditValue}}"
            placeholder="è¯·è¾“å…¥{{editTitle}}"
            bindinput="onFieldChange"
          />
        </block>
      </view>
      
      <view class="edit-popup-footer">
        <button class="btn-cancel" bindtap="closeEditPopup">å–æ¶ˆ</button>
        <button class="btn-confirm" bindtap="saveEdit">ä¿å­˜</button>
      </view>
    </view>
  </view>
</view> 